<!DOCTYPE html>
<html lang="en" xmlns:th="https://www.thymeleaf.org">
<head>
    <title>Bảng thống kê</title>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0"/>
    <meta name="description" content="POS - Bootstrap Admin Template"/>
    <meta name="keywords"
          content="admin, estimates, bootstrap, business, corporate, creative, management, minimal, modern,  html5, responsive"/>
    <meta name="author" content="Dreamguys - Bootstrap Admin Template"/>
    <meta name="robots" content="noindex, nofollow"/>
    <link rel="shortcut icon" type="image/x-icon" th:href="@{/assets/admin/img/favicon.png}"/>
    <link rel="stylesheet" th:href="@{/assets/admin/css/bootstrap.min.css}"/>
    <link rel="stylesheet" th:href="@{/assets/admin/css/bootstrap-datetimepicker.min.css}"/>
    <link rel="stylesheet" th:href="@{/assets/admin/css/animate.css}"/>
    <link rel="stylesheet" th:href="@{/assets/admin/css/bootstrap-datetimepicker.min.css}"/>
    <link rel="stylesheet" th:href="@{/assets/admin/plugins/select2/css/select2.min.css}"/>
    <link rel="stylesheet" th:href="@{/assets/admin/css/dataTables.bootstrap4.min.css}"/>
    <link rel="stylesheet" th:href="@{/assets/admin/plugins/fontawesome/css/fontawesome.min.css}"/>
    <link rel="stylesheet" th:href="@{/assets/admin/plugins/fontawesome/css/all.min.css}"/>
    <link rel="stylesheet" th:href="@{/assets/admin/css/style.css}"/>
</head>
<body>
<div id="global-loader">
    <div class="whirly-loader"></div>
</div>
<div class="main-wrapper">
    <th:block th:replace="~{component/admin/header/headerAdmin :: header}"></th:block>
    <th:block th:replace="~{component/admin/sidebar/SideBarAdmin :: sliderbarAdmin}"></th:block>
    <div class="page-wrapper">
        <div class="content">
            <div class="row">
                <div class="col-lg-4 col-sm-6 col-12">
                    <div class="dash-widget dash1">
                        <div class="dash-widgetimg">
                  <span>
                    <img th:src="@{/assets/admin/img/icons/dash2.svg}" alt="img"/>
                  </span>
                        </div>
                        <div class="dash-widgetcontent">
                            <h5>₫ <span class="counters"
                                        th:text="${#numbers.formatDecimal(totalDoanhThuNam, 0, 'COMMA', 0,'POINT')}"></span>
                            </h5>
                            <h6>Tổng doanh thu năm [[${yearPresent}]]</h6>
                        </div>
                    </div>
                </div>
                <div class="col-lg-4 col-sm-6 col-12">
                    <div class="dash-widget">
                        <div class="dash-widgetimg">
                  <span>
                    <img th:src="@{/assets/admin/img/icons/dash1.svg}" alt="img"/>
                  </span>
                        </div>
                        <div class="dash-widgetcontent">
                            <h5><span class="counters">[[${sumSanPhamDaBanTrongNam}]]</span></h5>
                            <h6>Sản phẩm đã bán</h6>
                        </div>
                    </div>
                </div>
                <div class="col-lg-4 col-sm-6 col-12">
                    <div class="dash-widget dash2">
                        <div class="dash-widgetimg">
                  <span>
                    <img th:src="@{/assets/admin/img/icons/dash3.svg}" alt="img"/>
                  </span>
                        </div>
                        <div class="dash-widgetcontent">
                            <h5><span class="counters"
                                      th:text="${#numbers.formatDecimal(totalProductsInStock, 0, 'POINT',0, 'COMMA')}"></span>
                            </h5>
                            <h6>Hàng còn trong kho</h6>
                        </div>
                    </div>
                </div>
                <div class="col-lg-6 col-sm-6 col-12 d-flex">
                    <div class="dash-count">
                        <div class="dash-counts">
                            <h4 th:text="${countUser}"></h4>
                            <h5>Khách hàng</h5>
                        </div>
                        <div class="dash-imgs">
                            <i data-feather="user">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                                     fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                     stroke-linejoin="round" class="feather feather-user">
                                    <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                                    <circle cx="12" cy="7" r="4"></circle>
                                </svg>
                            </i>
                        </div>
                    </div>
                </div>
                <div class="col-lg-6 col-sm-6 col-12 d-flex">
                    <div class="dash-count das3">
                        <div class="dash-counts">
                            <h4 th:text="${countOrders}"></h4>
                            <h5>Số lượng hoá đơn</h5>
                        </div>
                        <div class="dash-imgs">
                            <i data-feather="file">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                                     fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                     stroke-linejoin="round" class="feather feather-file">
                                    <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path>
                                    <polyline points="13 2 13 9 20 9"></polyline>
                                </svg>
                            </i>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-lg-7 col-sm-12 col-12 d-flex">
                    <div class="card flex-fill">
                        <div class="card">
                            <div class="card-header pb-0 d-flex justify-content-between align-items-center">
                                <h5 class="card-title mb-0">Biểu đồ doanh thu</h5>
                                <div class="graph-sets">
                                    <div class="dropdown">
                                        <button
                                                class="btn btn-white btn-sm dropdown-toggle"
                                                type="button"
                                                id="dropdownMenuButton"
                                                data-bs-toggle="dropdown"
                                                aria-expanded="false"
                                        >[[${yearPresent}]]<img
                                                th:src="@{/assets/admin/img/icons/dropdown.svg}" alt="img"
                                                class="ms-2"/>
                                        </button>
                                        <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                                            <th:block th:each="year : ${listYear}">
                                                <li>
                                                    <a th:href="@{/admin/dashboard(year=${year})}" class="dropdown-item"
                                                       th:text="${year}"></a>
                                                </li>
                                            </th:block>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            <div class="card-body">
                                <div id="s-line" class="chart-set"></div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-5 col-sm-12 col-12 d-flex">
                    <div class="card flex-fill">
                        <div class="card-header pb-0 d-flex justify-content-between align-items-center">
                            <h4 class="card-title mb-0">Sản phẩm được thêm gần đây</h4>
                            <div class="dropdown">
                                <a href="javascript:void(0);" data-bs-toggle="dropdown" aria-expanded="false"
                                   class="dropset">
                                    <i class="fa fa-ellipsis-v"></i>
                                </a>
                                <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                                    <li>
                                        <a href="productlist.html" class="dropdown-item">Product List</a>
                                    </li>
                                    <li>
                                        <a href="addproduct.html" class="dropdown-item">Product Add</a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="table-responsive dataview">
                                <table class="table datatable">
                                    <thead>
                                    <tr>
                                        <th>Sno</th>
                                        <th>Sản phẩm</th>
                                        <th style="text-align: end">Giá</th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    <th:block th:each="product, itemStat : ${listProduct}">
                                        <tr>
                                            <td th:text="${itemStat.count}">1</td>
                                            <td class="productimgname">
                                                <a class="product-img">
                                                    <img th:if="${product.getProductVariants() != null}"
                                                         th:src="${product.getProductVariants().get(0).getImage1()}"
                                                         alt="product"
                                                         style="object-fit: cover; object-position: top;height: auto"/>
                                                </a>
                                                <a href="#" th:text="${product.getProductName()}"></a>
                                            </td>
                                            <td style="text-align: end">₫
                                                [[${#numbers.formatDecimal(product.getPriceNew(), 0, 'COMMA', 0,
                                                'POINT')}]]
                                            </td>
                                        </tr>
                                    </th:block>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script th:src="@{/assets/admin/js/jquery-3.6.0.min.js}"></script>
<script th:src="@{/assets/admin/js/feather.min.js}"></script>
<script th:src="@{/assets/admin/js/jquery.slimscroll.min.js}"></script>
<script th:src="@{/assets/admin/js/jquery.dataTables.min.js}"></script>
<script th:src="@{/assets/admin/js/dataTables.bootstrap4.min.js}"></script>
<script th:src="@{/assets/admin/js/bootstrap.bundle.min.js}"></script>
<script th:src="@{/assets/admin/plugins/apexchart/apexcharts.min.js}"></script>
<script th:src="@{/assets/admin/js/script.js}"></script>
<script th:inline="javascript">
    'use strict';
    /*<![CDATA[*/
    var moneyDoanhThu = [];
    var monthDoanhThu = [];
    /*[# th:each="object : ${listDoanhThu}"]*/
    moneyDoanhThu.push(/*[[${object[0]}]]*/);
    monthDoanhThu.push(/*[[${object[1]}]]*/);
    /*[/]*/
    console.log(moneyDoanhThu);
    console.log(monthDoanhThu);
    /*]]>*/
    $(document).ready(function () {
        if ($('#s-line').length > 0) {
            var sline = {
                chart: {
                    height: 350,
                    type: 'line',
                    zoom: {
                        enabled: false,
                    },
                    toolbar: {
                        show: false,
                    },
                },
                dataLabels: {
                    enabled: false,
                },
                stroke: {
                    curve: 'straight',
                },
                series: [
                    {
                        name: '₫',
                        data: moneyDoanhThu,
                    },
                ],
                title: {
                    // text: 'Product Trends by Month',
                    // align: 'left',
                },
                grid: {
                    row: {
                        colors: ['#f1f2f3', 'transparent'],
                        opacity: 0.5,
                    },
                },
                xaxis: {
                    categories: monthDoanhThu,
                },
            };
            var chart = new ApexCharts(document.querySelector('#s-line'), sline);
            chart.render();
        }
    });
</script>
</body>
</html>